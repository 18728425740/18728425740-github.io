(()=>{"use strict";var t={353:(t,e)=>{function n(){try{return top.location.href}catch(t){return window.src_url||document.referrer}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.type,o=t.code,r=void 0===o?0:o,i=t.cost,s=void 0===i?0:i,a=t.param,c=void 0===a?"":a,u=t.result,d=void 0===u?"":u,p=t.wxa_appid,f=void 0===p?"":p,l=t.appid,h=void 0===l?"":l,w=t.path,_=void 0===w?"":w,m=t.src_url,v=void 0===m?"":m,y=JSON.stringify([{biz_id:2466,refer:n(),time:Math.floor(Date.now()/1e3),type:e,code:r,cost:s,wxa_appid:f,appid:h,path:_,param:c,result:d,src_url:v}]),g=new XMLHttpRequest;g.open("POST","https://cube.weixinbridge.com/cube/report/reportbizdata?f=json"),g.send(y)}},428:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,o){return void 0===e&&(e="GET"),void 0===o&&(o=0),new Promise((function(r,i){var s=new XMLHttpRequest;s.open(e,t),s.timeout=o,s.onerror=i,s.ontimeout=i,s.onloadend=function(){return r({status:s.status,type:s.responseType,data:s.response})},n&&"object"==typeof n?(s.setRequestHeader("Content-Type","application/json"),s.send(JSON.stringify(n))):s.send(n)}))}},753:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r,i=o(n(353)),s=o(n(428)),a="",c=0,u=[],d=new Map,p=document.currentScript.getAttribute("src"),f=document.createElement("iframe");f.style.display="none",f.src=p.replace(/\/[^/]+$/,"/index.html");var l=new Promise((function(t){return r=t}));window.onload=function(){document.body.appendChild(f),r()};var h=function(){function t(){var t=this;this.element=document.createElement("iframe"),this.element.src=p.replace(/\/[^/]+$/,"/index.html"),this._ready=new Promise((function(e){return t.element.onload=e})),this._post({action:"setId",id:u.length}),this._post({action:"setSrc",src:location.href}),this._post({action:"setHost",host:a}),u.push(this)}return t.prototype._post=function(t){var e=this;this._ready.then((function(){return e.element.contentWindow.postMessage(t,"*")}))},Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(t){this._post({action:"setText",text:this._text=t})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(t){this._post({action:"setStyle",style:this._style=t})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"info",{get:function(){return this._info},set:function(t){this._post({action:"setInfo",info:this._info=t})},enumerable:!1,configurable:!0}),t}();window.addEventListener("message",(function(t){var e=t.data,n=e||{},o=n.id,r=n.rid;if(u[o]){var i=u[o].onresult;i&&i(e)}else d.has(r)&&(delete e.rid,d.get(r)(e),d.delete(r))})),Object.assign(window,{getWxToken:function(){return new Promise((function(t,e){for(var n=Date.now(),o=0,r=function(r){o++;var c="http://127.0.0.1:"+r;(0,s.default)(c+"/hi","GET",null,1e3).then((function(r){var s=r.data;if("string"==typeof s){var d=JSON.parse(s);if("wechat"===d.client)if(d.code)o=0,(0,i.default)({type:"getWxToken",code:1,cost:Date.now()-n,param:c,result:s,src_url:window.location.href}),e(d.data);else{o=0;var p={action:"setHost",host:a=c};u.forEach((function(t){return t._post(p)})),l.then((function(){f.contentWindow.postMessage(p,"*")})),(0,i.default)({type:"getWxToken",code:0,cost:Date.now()-n,param:c,result:s,src_url:window.location.href}),t(d.data)}}})).catch((function(){0==--o&&((0,i.default)({type:"getWxToken",code:2,cost:Date.now()-n,param:"",result:"wechat not launched",src_url:window.location.href}),e("请登录最新版微信"))}))},c=8680;c<=8688;c++)r(c)}))},launchWeApp:function(t){var e=++c;return new Promise((function(n,o){f.contentWindow.postMessage({host:a,args:t,rid:e,action:"launch",src:location.href},"*"),d.set(e,(function(t){t.errcode?o(t):n(t)}))}))},WxButton:h})}},e={};!function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,n),i.exports}(753)})();